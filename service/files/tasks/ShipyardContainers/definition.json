{
    "name": "ShipyardContainers",
    "taskScript": "var options = {\n  url: 'http://46.101.191.124:8080',\n  headers: { 'X-Service-Key': 'pdE4.JVg43HyxCEMWvsFvu6bdFV7LwA7YPii' }\n};\nvar containers = new Containers();\ncontainers[task.method.toLowerCase()]();\n\nfunction Containers(){\n\n  this.get = read;\n  this.post = create;\n  this.delete = remove;\n  \n  function create(){\n  \n  \tvar conf = {\n    \tname: '46.101.191.124:5000/' + task.params.name + ':' + task.params.version,\n        cpus: task.params.cpu || 0.1,\n\t\tmemory: task.params.memory || 32,\n        hostname: task.params.hostname || '',\n        domain: task.params.domain || '',\n        type: 'service',\n        bind_ports: [\n           {\n              proto: 'tcp',\n              host_ip: null,\n              port: task.params.port,\n              container_port: task.params.port\n           }\n        ],\n        labels:task.params.labels || [],\n        environment: task.params.environment || {}\n    };\n  \n  \n  \treturn task.json(options)\n    \t.post('/api/containers?pull=true', conf)\n        .then(function(data){\n          task.done(null, data);\n       \t})\n        .catch(function(error){\n          task.done(error);\n        });\n  }\n  \n  function read(){\n    return task.json(options)\n     .get('/api/containers')\n     .then(function(data){\n        task.done(null, data);\n     })\n     .catch(function(error){\n     \ttask.done(error);\n     });\n  }\n  \n  function remove(){\n  \n    return task.json(options)\n     .del('/api/containers/'+task.params[1])\n     .then(function(data){\n        task.done(null, data);\n     })\n     .catch(function(error){\n     \ttask.done(error);\n     });\n  }\n\n}",
    "anonymous": true
}